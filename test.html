<!doctype html>
<html>

<head>
    <title>Bitdeli JS Tracking library test</title>
    <script type="text/javascript">
        // Set up global command queue
        var _bdq = _bdq || [];
        _bdq["__SV"] = "0.0.1";
        _bdq.push(["setAccount", "BITDELI_INPUT_ID", "BITDELI_INPUT_AUTH"]);
        // _bdq.push(["identify", "USER_ID"]);

        (function() {
            // Create script element
            var bd = document.createElement("script");
            bd.type = "text/javascript";
            bd.async = true;
            bd.src = "build/bitdeli-0.0.1.js";

            // Load script by inserting it in DOM
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bd, s);
        })();
    </script>
    <script type="text/javascript">
        (function() {

        console.log("******** BEGIN TEST ********");

        var callback = function(method) {
            return function(resp, data, timedOut) {
                var success = resp === 1 || resp.uid;
                console.log(success ? "SUCCESS" : "ERROR", method, this);
                console.log("response", JSON.stringify(resp));
                console.log("data", JSON.stringify(data));
                console.log("---");
            };
        };

        _bdq.push(["setOnce", { initialReferrer: document.referrer }]);
        _bdq.push(["set", { username: "foobar" }]);
        _bdq.push(["trackEvent", { action: "test" }, callback("trackEvent")]);
        _bdq.push(["trackClick", ".outbound-link", { action: "click" }, callback("trackClick")]);
        _bdq.push(["trackSubmit", "#test-form", { action: "submit" }, callback("trackSubmit")]);

        })();
    </script>
</head>

<body>

<h1>Bitdeli JS Tracking library test</h1>

<ul>
    <li><a href="test.html?1" class="outbound-link">Outbound link 1</a></li>
    <li><a href="test.html?2" class="outbound-link">Outbound link 2</a></li>
    <li><a href="test.html?3" class="outbound-link">Outbound link 3</a></li>
</ul>

<form id="test-form">
    <button type="submit">Submit form</button>
</form>

</body>

</html>
